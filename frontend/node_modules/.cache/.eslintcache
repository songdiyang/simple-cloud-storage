[{"D:\\cloud-storage-system\\frontend\\src\\index.js":"1","D:\\cloud-storage-system\\frontend\\src\\App.js":"2","D:\\cloud-storage-system\\frontend\\src\\contexts\\AuthContext.js":"3","D:\\cloud-storage-system\\frontend\\src\\pages\\Login.js":"4","D:\\cloud-storage-system\\frontend\\src\\pages\\Dashboard.js":"5","D:\\cloud-storage-system\\frontend\\src\\pages\\Files.js":"6","D:\\cloud-storage-system\\frontend\\src\\pages\\Register.js":"7","D:\\cloud-storage-system\\frontend\\src\\pages\\Profile.js":"8","D:\\cloud-storage-system\\frontend\\src\\components\\Header.js":"9","D:\\cloud-storage-system\\frontend\\src\\components\\Sidebar.js":"10","D:\\cloud-storage-system\\frontend\\src\\pages\\Shares.js":"11","D:\\cloud-storage-system\\frontend\\src\\services\\api.js":"12"},{"size":862,"mtime":1764225917797,"results":"13","hashOfConfig":"14"},{"size":1892,"mtime":1764233710194,"results":"15","hashOfConfig":"14"},{"size":3686,"mtime":1764225995879,"results":"16","hashOfConfig":"14"},{"size":6533,"mtime":1764233929601,"results":"17","hashOfConfig":"14"},{"size":5700,"mtime":1764232088898,"results":"18","hashOfConfig":"14"},{"size":13659,"mtime":1764243922460,"results":"19","hashOfConfig":"14"},{"size":4970,"mtime":1764226088178,"results":"20","hashOfConfig":"14"},{"size":8126,"mtime":1764242631016,"results":"21","hashOfConfig":"14"},{"size":2447,"mtime":1764226008596,"results":"22","hashOfConfig":"14"},{"size":2120,"mtime":1764226020556,"results":"23","hashOfConfig":"14"},{"size":6855,"mtime":1764226185756,"results":"24","hashOfConfig":"14"},{"size":793,"mtime":1764225998631,"results":"25","hashOfConfig":"14"},{"filePath":"26","messages":"27","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},"sl1nzn",{"filePath":"29","messages":"30","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},{"filePath":"31","messages":"32","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},{"filePath":"33","messages":"34","errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"35","usedDeprecatedRules":"28"},{"filePath":"36","messages":"37","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},{"filePath":"38","messages":"39","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"40","messages":"41","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},{"filePath":"42","messages":"43","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"44","messages":"45","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},{"filePath":"46","messages":"47","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},{"filePath":"48","messages":"49","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"50","usedDeprecatedRules":"28"},{"filePath":"51","messages":"52","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},"D:\\cloud-storage-system\\frontend\\src\\index.js",[],["53","54"],"D:\\cloud-storage-system\\frontend\\src\\App.js",[],"D:\\cloud-storage-system\\frontend\\src\\contexts\\AuthContext.js",[],"D:\\cloud-storage-system\\frontend\\src\\pages\\Login.js",["55","56","57"],"import React, { useState, useEffect } from 'react';\nimport { Form, Input, Button, Card, Typography, message, Alert, Spin } from 'antd';\nimport { UserOutlined, LockOutlined, CloudOutlined, ReloadOutlined } from '@ant-design/icons';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { useAuth } from '../contexts/AuthContext';\nimport api from '../services/api';\n\nconst { Title, Text } = Typography;\n\nconst Login = () => {\n  const [loading, setLoading] = useState(false);\n  const [apiStatus, setApiStatus] = useState({ checking: true, online: false });\n  const { login } = useAuth();\n  const navigate = useNavigate();\n\n  // 检查API连接状态\n  useEffect(() => {\n    const checkApiStatus = async () => {\n      try {\n        const response = await api.get('/api/auth/', { timeout: 5000 });\n        setApiStatus({ checking: false, online: true });\n      } catch (error) {\n        setApiStatus({ checking: false, online: false });\n        console.warn('API连接检查失败:', error.message);\n      }\n    };\n\n    checkApiStatus();\n  }, []);\n\n  const onFinish = async (values) => {\n    setLoading(true);\n    try {\n      const result = await login(values);\n      if (result.success) {\n        message.success('登录成功！正在跳转...');\n        setTimeout(() => navigate('/dashboard'), 1000);\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleRetryApi = () => {\n    setApiStatus({ checking: true, online: false });\n    setTimeout(() => {\n      checkApiStatus();\n    }, 1000);\n  };\n\n  const checkApiStatus = async () => {\n    try {\n      await api.get('/api/auth/', { timeout: 5000 });\n      setApiStatus({ checking: false, online: true });\n    } catch (error) {\n      setApiStatus({ checking: false, online: false });\n    }\n  };\n\n  return (\n    <div style={{\n      minHeight: '100vh',\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      padding: '20px',\n      background: '#f0f2f5',\n      fontFamily: '-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif'\n    }}>\n      {/* API状态提示 */}\n      {!apiStatus.checking && !apiStatus.online && (\n        <div style={{\n          position: 'absolute',\n          top: '20px',\n          left: '50%',\n          transform: 'translateX(-50%)',\n          zIndex: 1000,\n          width: '90%',\n          maxWidth: '400px'\n        }}>\n          <Alert\n            message=\"服务连接失败\"\n            description=\"无法连接到服务器，请检查网络连接或稍后重试。\"\n            type=\"error\"\n            showIcon\n            closable={false}\n            action={\n              <Button size=\"small\" onClick={handleRetryApi}>\n                重试\n              </Button>\n            }\n            style={{ borderRadius: '8px' }}\n          />\n        </div>\n      )}\n\n      <Card\n        style={{\n          width: '100%',\n          maxWidth: '360px',\n          padding: '40px 32px',\n          border: '1px solid #d9d9d9',\n          borderRadius: '8px',\n          boxShadow: '0 4px 12px rgba(0, 0, 0, 0.08)'\n        }}\n        bodyStyle={{ padding: 0 }}\n      >\n        <div style={{ textAlign: 'center', marginBottom: '32px' }}>\n          <div style={{\n            width: '64px',\n            height: '64px',\n            background: '#1890ff',\n            borderRadius: '50%',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            color: 'white',\n            fontSize: '28px',\n            margin: '0 auto 20px'\n          }}>\n            <CloudOutlined />\n          </div>\n          <Title level={3} style={{ \n            color: '#262626', \n            margin: '0 0 8px 0',\n            fontSize: '24px',\n            fontWeight: 600\n          }}>\n            登录\n          </Title>\n          <Text style={{ \n            color: '#8c8c8c',\n            fontSize: '14px'\n          }}>\n            欢迎使用云存储系统\n          </Text>\n        </div>\n\n          <Form\n            name=\"login\"\n            onFinish={onFinish}\n            layout=\"vertical\"\n            size=\"large\"\n            style={{ marginTop: '24px' }}\n          >\n            <Form.Item\n              name=\"username\"\n              rules={[{ required: true, message: '请输入用户名' }]}\n              style={{ marginBottom: '16px' }}\n            >\n              <Input\n                prefix={<UserOutlined style={{ color: '#8c8c8c' }} />}\n                placeholder=\"用户名\"\n                style={{\n                  height: '40px',\n                  border: '1px solid #d9d9d9',\n                  borderRadius: '6px'\n                }}\n              />\n            </Form.Item>\n\n            <Form.Item\n              name=\"password\"\n              rules={[{ required: true, message: '请输入密码' }]}\n              style={{ marginBottom: '24px' }}\n            >\n              <Input.Password\n                prefix={<LockOutlined style={{ color: '#8c8c8c' }} />}\n                placeholder=\"密码\"\n                style={{\n                  height: '40px',\n                  border: '1px solid #d9d9d9',\n                  borderRadius: '6px'\n                }}\n              />\n            </Form.Item>\n\n            <Form.Item style={{ marginBottom: '16px' }}>\n              <Button\n                type=\"primary\"\n                htmlType=\"submit\"\n                loading={loading}\n                disabled={!apiStatus.online && !apiStatus.checking}\n                block\n                style={{\n                  height: '40px',\n                  fontSize: '16px',\n                  fontWeight: 500,\n                  backgroundColor: '#1890ff',\n                  borderColor: '#1890ff',\n                  borderRadius: '6px'\n                }}\n              >\n                {loading ? '登录中...' : '登录'}\n              </Button>\n            </Form.Item>\n          </Form>\n\n          <div style={{ \n            textAlign: 'center',\n            borderTop: '1px solid #f0f0f0',\n            paddingTop: '16px',\n            marginTop: '16px'\n          }}>\n            <Text style={{ color: '#8c8c8c', fontSize: '14px' }}>\n              还没有账号？{' '}\n              <Link \n                to=\"/register\" \n                style={{ \n                  color: '#1890ff',\n                  textDecoration: 'none',\n                  fontWeight: 500\n                }}\n              >\n                立即注册\n              </Link>\n            </Text>\n          </div>\n        </Card>\n    </div>\n  );\n};\n\nexport default Login;","D:\\cloud-storage-system\\frontend\\src\\pages\\Dashboard.js",[],"D:\\cloud-storage-system\\frontend\\src\\pages\\Files.js",[],"D:\\cloud-storage-system\\frontend\\src\\pages\\Register.js",[],"D:\\cloud-storage-system\\frontend\\src\\pages\\Profile.js",[],"D:\\cloud-storage-system\\frontend\\src\\components\\Header.js",[],"D:\\cloud-storage-system\\frontend\\src\\components\\Sidebar.js",[],"D:\\cloud-storage-system\\frontend\\src\\pages\\Shares.js",["58","59"],"import React, { useState } from 'react';\nimport { \n  Card, \n  Table, \n  Button, \n  Modal, \n  Form, \n  Input, \n  DatePicker, \n  InputNumber,\n  message,\n  Space,\n  Tag,\n  Typography,\n  Popconfirm,\n  Tooltip\n} from 'antd';\nimport { \n  ShareAltOutlined, \n  PlusOutlined, \n  DeleteOutlined,\n  CopyOutlined,\n  EyeOutlined\n} from '@ant-design/icons';\nimport { useQuery, useMutation, useQueryClient } from 'react-query';\nimport dayjs from 'dayjs';\nimport api from '../services/api';\n\nconst { Title, Text } = Typography;\nconst { RangePicker } = DatePicker;\n\nconst Shares = () => {\n  const queryClient = useQueryClient();\n  const [createModalVisible, setCreateModalVisible] = useState(false);\n  const [shareForm] = Form.useForm();\n\n  const { data: shares = [], isLoading } = useQuery(\n    'my-shares',\n    () => api.get('/api/files/shares/').then(res => res.data)\n  );\n\n  const createShareMutation = useMutation(\n    (data) => api.post('/api/files/shares/create/', data),\n    {\n      onSuccess: () => {\n        message.success('分享创建成功！');\n        setCreateModalVisible(false);\n        shareForm.resetFields();\n        queryClient.invalidateQueries('my-shares');\n      },\n      onError: (error) => {\n        const errorMsg = error.response?.data?.error || '创建失败';\n        message.error(errorMsg);\n      }\n    }\n  );\n\n  const deleteShareMutation = useMutation(\n    (shareId) => api.delete(`/api/files/shares/${shareId}/delete/`),\n    {\n      onSuccess: () => {\n        message.success('分享已取消！');\n        queryClient.invalidateQueries('my-shares');\n      },\n      onError: (error) => {\n        const errorMsg = error.response?.data?.error || '取消失败';\n        message.error(errorMsg);\n      }\n    }\n  );\n\n  const columns = [\n    {\n      title: '文件名',\n      dataIndex: 'file_name',\n      key: 'file_name',\n      render: (text) => (\n        <Tooltip title={text}>\n          <Text ellipsis style={{ maxWidth: '200px' }}>{text}</Text>\n        </Tooltip>\n      ),\n    },\n    {\n      title: '文件大小',\n      dataIndex: 'file_size_display',\n      key: 'file_size_display',\n    },\n    {\n      title: '分享码',\n      dataIndex: 'share_code',\n      key: 'share_code',\n      render: (code, record) => (\n        <Space>\n          <Tag color=\"blue\">{code}</Tag>\n          <Button\n            type=\"text\"\n            size=\"small\"\n            icon={<CopyOutlined />}\n            onClick={() => {\n              navigator.clipboard.writeText(`${window.location.origin}/share/${code}`);\n              message.success('分享链接已复制到剪贴板！');\n            }}\n          />\n        </Space>\n      ),\n    },\n    {\n      title: '状态',\n      dataIndex: 'is_active',\n      key: 'is_active',\n      render: (isActive, record) => (\n        <Space direction=\"vertical\" size=\"small\">\n          <Tag color={isActive ? 'green' : 'red'}>\n            {isActive ? '有效' : '无效'}\n          </Tag>\n          {record.is_expired && (\n            <Tag color=\"orange\">已过期</Tag>\n          )}\n        </Space>\n      ),\n    },\n    {\n      title: '下载次数',\n      dataIndex: 'download_count',\n      key: 'download_count',\n      render: (count, record) => (\n        <Text>\n          {count} / {record.max_downloads || '无限制'}\n        </Text>\n      ),\n    },\n    {\n      title: '过期时间',\n      dataIndex: 'expire_at',\n      key: 'expire_at',\n      render: (time) => time ? dayjs(time).format('YYYY-MM-DD HH:mm') : '永不过期',\n    },\n    {\n      title: '创建时间',\n      dataIndex: 'created_at',\n      key: 'created_at',\n      render: (time) => dayjs(time).format('YYYY-MM-DD HH:mm'),\n    },\n    {\n      title: '操作',\n      key: 'actions',\n      render: (_, record) => (\n        <Space>\n          <Button\n            type=\"text\"\n            size=\"small\"\n            icon={<EyeOutlined />}\n            onClick={() => window.open(`/share/${record.share_code}`, '_blank')}\n          />\n          <Popconfirm\n            title=\"确定取消这个分享吗？\"\n            onConfirm={() => deleteShareMutation.mutate(record.id)}\n            okText=\"确定\"\n            cancelText=\"取消\"\n          >\n            <Button\n              type=\"text\"\n              danger\n              size=\"small\"\n              icon={<DeleteOutlined />}\n            />\n          </Popconfirm>\n        </Space>\n      ),\n    },\n  ];\n\n  return (\n    <div>\n      <div style={{ marginBottom: '24px', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n        <Title level={2} style={{ color: '#333', margin: 0 }}>\n          我的分享\n        </Title>\n        \n        <Button \n          type=\"primary\" \n          icon={<PlusOutlined />}\n          onClick={() => setCreateModalVisible(true)}\n          className=\"cel-button\"\n        >\n          创建分享\n        </Button>\n      </div>\n\n      <Card className=\"cel-card\">\n        <Table\n          columns={columns}\n          dataSource={shares}\n          rowKey=\"id\"\n          loading={isLoading}\n          pagination={{\n            pageSize: 10,\n            showSizeChanger: false,\n            showQuickJumper: true,\n          }}\n        />\n      </Card>\n\n      {/* 创建分享模态框 */}\n      <Modal\n        title=\"创建文件分享\"\n        open={createModalVisible}\n        onOk={() => shareForm.submit()}\n        onCancel={() => setCreateModalVisible(false)}\n        confirmLoading={createShareMutation.isLoading}\n        width={600}\n      >\n        <Form\n          form={shareForm}\n          layout=\"vertical\"\n          onFinish={(values) => {\n            // 这里需要先选择文件，然后创建分享\n            // 简化起见，这里只是示例\n            message.info('请先在文件页面选择要分享的文件');\n          }}\n        >\n          <Form.Item>\n            <Text type=\"secondary\">\n              请前往\"我的文件\"页面，点击文件操作栏的分享按钮来创建分享链接。\n            </Text>\n          </Form.Item>\n          \n          <Form.Item\n            name=\"password\"\n            label=\"访问密码（可选）\"\n          >\n            <Input.Password placeholder=\"留空表示无需密码\" />\n          </Form.Item>\n          \n          <Form.Item\n            name=\"expire_at\"\n            label=\"过期时间（可选）\"\n          >\n            <DatePicker\n              showTime\n              placeholder=\"留空表示永不过期\"\n              style={{ width: '100%' }}\n            />\n          </Form.Item>\n          \n          <Form.Item\n            name=\"max_downloads\"\n            label=\"最大下载次数（可选）\"\n          >\n            <InputNumber\n              placeholder=\"留空表示无限制\"\n              style={{ width: '100%' }}\n              min={1}\n            />\n          </Form.Item>\n        </Form>\n      </Modal>\n    </div>\n  );\n};\n\nexport default Shares;","D:\\cloud-storage-system\\frontend\\src\\services\\api.js",[],{"ruleId":"60","replacedBy":"61"},{"ruleId":"62","replacedBy":"63"},{"ruleId":"64","severity":1,"message":"65","line":2,"column":65,"nodeType":"66","messageId":"67","endLine":2,"endColumn":69},{"ruleId":"64","severity":1,"message":"68","line":3,"column":53,"nodeType":"66","messageId":"67","endLine":3,"endColumn":67},{"ruleId":"64","severity":1,"message":"69","line":20,"column":15,"nodeType":"66","messageId":"67","endLine":20,"endColumn":23},{"ruleId":"64","severity":1,"message":"70","line":19,"column":3,"nodeType":"66","messageId":"67","endLine":19,"endColumn":19},{"ruleId":"64","severity":1,"message":"71","line":30,"column":9,"nodeType":"66","messageId":"67","endLine":30,"endColumn":20},"no-native-reassign",["72"],"no-negated-in-lhs",["73"],"no-unused-vars","'Spin' is defined but never used.","Identifier","unusedVar","'ReloadOutlined' is defined but never used.","'response' is assigned a value but never used.","'ShareAltOutlined' is defined but never used.","'RangePicker' is assigned a value but never used.","no-global-assign","no-unsafe-negation"]